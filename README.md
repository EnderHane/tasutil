# Celeste TAS 命令行小工具

## 构建

安装 [Rust 工具](https://www.rust-lang.org/zh-CN/)，在 Cargo.toml 所在的目录中运行
```
cargo build --release
```
完成后，在 target/release 获取可执行文件 tasutil(.exe)。

## 命令树

```
tasutil(.exe)
|
+-- format{,fmt}
|   |
|   +-- scan-breakpoint[,sb]
|        检查当前目录及其子目录中所有tas文件是否含有“***”
|  
+-- lobby 
    |
    +-- info[,i] [选项]
    |   |生成大厅信息
    |   +-- 选项
    |       +-- --dir[,-d] <目录>
    |            大厅tas文件所在的目录，默认为当前目录
    |
    +-- route[,r] [选项]
    |   |计算大厅路线
    |   +-- 选项
    |       +-- --dir[,-d] <目录>
    |       |    大厅tas文件所在的目录，默认为当前目录
    |       +-- --num[,-n] <数量>
    |       |    用时最短路径的最大收留数，默认为1
    |       +-- --show-arc
    |            显示弧长，默认不显示
    |
    +-- generate-input[,gi]
         （尚不完善）   
```

## 示例

以下示例使用 https://github.com/EnderHane/Valentines-Day-Contest-2021-TAS

```tasutil.exe fmt sb```
```
D:\games\Celeste\tas\Valentines-Day-Contest-2021-TAS> tasutil.exe fmt sb
Found 0 breakpoints in total 99 TAS files
```

```tasutil.exe lobby i --dir lobby```
```
D:\games\Celeste\tas\Valentines-Day-Contest-2021-TAS> tasutil.exe lobby i --dir lobby
Arc     Time    File
2->1    173     .\lobby\lobby_2-1.tas
20->8   241     .\lobby\lobby_20-8.tas
15->21  378     .\lobby\terminal_15-21.tas
20->7   234     .\lobby\lobby_20-7.tas
3->2    216     .\lobby\lobby_3-2.tas
4->5    203     .\lobby\lobby_4-5.tas
15->7   292     .\lobby\lobby_15-7.tas
18->17  283     .\lobby\lobby_18-17.tas
7->8    187     .\lobby\lobby_7-8.tas
20->14  230     .\lobby\lobby_20-14.tas
14->21  381     .\lobby\terminal_14-21.tas
19->20  161     .\lobby\lobby_19-20.tas
2->3    212     .\lobby\lobby_2-3.tas
14->13  212     .\lobby\lobby_14-13.tas
20->19  164     .\lobby\lobby_20-19.tas
17->16  200     .\lobby\lobby_17-16.tas
0->12   376     .\lobby\departure_0-12.tas
12->19  186     .\lobby\lobby_12-19.tas
3->4    177     .\lobby\lobby_3-4.tas
5->4    209     .\lobby\lobby_5-4.tas
5->3    209     .\lobby\lobby_5-3.tas
12->13  203     .\lobby\lobby_12-13.tas
13->14  241     .\lobby\lobby_13-14.tas
3->5    197     .\lobby\lobby_3-5.tas
19->8   217     .\lobby\lobby_19-8.tas
6->19   224     .\lobby\lobby_6-19.tas
20->18  243     .\lobby\lobby_20-18.tas
14->20  264     .\lobby\lobby_14-20.tas
17->1   187     .\lobby\lobby_17-1.tas
15->14  219     .\lobby\lobby_15-14.tas
0->20   381     .\lobby\departure_0-20.tas
6->18   228     .\lobby\lobby_6-18.tas
0->19   352     .\lobby\departure_0-19.tas
11->19  332     .\lobby\lobby_11-19.tas
15->20  197     .\lobby\lobby_15-20.tas
1->2    181     .\lobby\lobby_1-2.tas
13->12  205     .\lobby\lobby_13-12.tas
16->15  179     .\lobby\lobby_16-15.tas
19->7   215     .\lobby\lobby_19-7.tas
16->17  212     .\lobby\lobby_16-17.tas
15->16  205     .\lobby\lobby_15-16.tas
4->2    244     .\lobby\lobby_4-2.tas
20->21  417     .\lobby\terminal_20-21.tas
8->7    225     .\lobby\lobby_8-7.tas
14->15  263     .\lobby\lobby_14-15.tas
5->8    255     .\lobby\lobby_5-8.tas
6->7    184     .\lobby\lobby_6-7.tas
19->18  245     .\lobby\lobby_19-18.tas
12->11  165     .\lobby\lobby_12-11.tas
0->11   375     .\lobby\departure_0-11.tas
15->19  229     .\lobby\lobby_15-19.tas
20->15  235     .\lobby\lobby_20-15.tas
11->12  173     .\lobby\lobby_11-12.tas
18->1   285     .\lobby\lobby_18-1.tas
7->19   211     .\lobby\lobby_7-19.tas
8->9    194     .\lobby\lobby_8-9.tas
7->21   444     .\lobby\terminal_7-21.tas
5->6    188     .\lobby\lobby_5-6.tas
10->11  171     .\lobby\lobby_10-11.tas
4->3    172     .\lobby\lobby_4-3.tas
0->7    406     .\lobby\departure_0-7.tas
9->10   200     .\lobby\lobby_9-10.tas
6->5    202     .\lobby\lobby_6-5.tas
19->21  417     .\lobby\terminal_19-21.tas
1->17   176     .\lobby\lobby_1-17.tas
18->6   221     .\lobby\lobby_18-6.tas
18->16  273     .\lobby\lobby_18-16.tas
9->8    220     .\lobby\lobby_9-8.tas
18->19  189     .\lobby\lobby_18-19.tas
18->20  209     .\lobby\lobby_18-20.tas
7->6    203     .\lobby\lobby_7-6.tas
10->9   208     .\lobby\lobby_10-9.tas
2->4    244     .\lobby\lobby_2-4.tas
11->10  183     .\lobby\lobby_11-10.tas

Matrix in CSV:
,,,,,,,406,,,,375,376,,,,,,,352,381,
,,181,,,,,,,,,,,,,,,176,,,,
,173,,212,244,,,,,,,,,,,,,,,,,
,,216,,177,197,,,,,,,,,,,,,,,,
,,244,172,,203,,,,,,,,,,,,,,,,
,,,209,209,,188,,255,,,,,,,,,,,,,
,,,,,202,,184,,,,,,,,,,,228,224,,
,,,,,,203,,187,,,,,,,,,,,211,,444
,,,,,,,225,,194,,,,,,,,,,,,
,,,,,,,,220,,200,,,,,,,,,,,
,,,,,,,,,208,,171,,,,,,,,,,
,,,,,,,,,,183,,173,,,,,,,332,,
,,,,,,,,,,,165,,203,,,,,,186,,
,,,,,,,,,,,,205,,241,,,,,,,
,,,,,,,,,,,,,212,,263,,,,,264,381
,,,,,,,292,,,,,,,219,,205,,,229,197,378
,,,,,,,,,,,,,,,179,,212,,,,
,187,,,,,,,,,,,,,,,200,,,,,
,285,,,,,221,,,,,,,,,,273,283,,189,209,
,,,,,,,215,217,,,,,,,,,,245,,161,417
,,,,,,,234,241,,,,,,230,235,,,243,164,,417
,,,,,,,,,,,,,,,,,,,,,

```

```tasutil.exe lobby r --dir lobby --num 10```
```
D:\games\Celeste\tas\Valentines-Day-Contest-2021-TAS [main ≡]> tasutil.exe lobby r --dir lobby --num 10
Found 158 paths in "lobby"
Best 10 paths are
1)      [4526]  0-19-18-6-5-4-3-2-1-17-16-15-20-7-8-9-10-11-12-13-14-21
2)      [4540]  0-19-18-20-15-16-17-1-2-3-4-5-6-7-8-9-10-11-12-13-14-21
3)      [4545]  0-7-6-5-4-3-2-1-17-16-15-20-18-19-8-9-10-11-12-13-14-21
4)      [4546]  0-19-20-18-6-5-4-3-2-1-17-16-15-7-8-9-10-11-12-13-14-21
5)      [4559]  0-19-18-6-5-3-4-2-1-17-16-15-20-7-8-9-10-11-12-13-14-21
6)      [4561]  0-19-18-20-15-16-17-1-2-4-3-5-6-7-8-9-10-11-12-13-14-21
7)      [4562]  0-19-18-20-14-13-12-11-10-9-8-7-6-5-4-3-2-1-17-16-15-21
8)      [4563]  0-20-15-16-17-1-2-3-4-5-6-18-19-7-8-9-10-11-12-13-14-21
9)      [4566]  0-20-18-6-5-4-3-2-1-17-16-15-19-7-8-9-10-11-12-13-14-21
10)     [4569]  0-19-7-8-9-10-11-12-13-14-20-18-6-5-4-3-2-1-17-16-15-21
```

```tasutil.exe lobby r --dir lobby --num 10 --show-arc```
```
D:\games\Celeste\tas\Valentines-Day-Contest-2021-TAS> tasutil.exe lobby r --dir lobby --num 10 --show-arc
Found 158 paths in "lobby"
Best 10 paths are
1)      [4526]  0-<352>-19-<245>-18-<221>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<197>-20-<234>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
2)      [4540]  0-<352>-19-<245>-18-<209>-20-<235>-15-<205>-16-<212>-17-<187>-1-<181>-2-<212>-3-<177>-4-<203>-5-<188>-6-<184>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
3)      [4545]  0-<406>-7-<203>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<197>-20-<243>-18-<189>-19-<217>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
4)      [4546]  0-<352>-19-<161>-20-<243>-18-<221>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<292>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
5)      [4559]  0-<352>-19-<245>-18-<221>-6-<202>-5-<209>-3-<177>-4-<244>-2-<173>-1-<176>-17-<200>-16-<179>-15-<197>-20-<234>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
6)      [4561]  0-<352>-19-<245>-18-<209>-20-<235>-15-<205>-16-<212>-17-<187>-1-<181>-2-<244>-4-<172>-3-<197>-5-<188>-6-<184>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
7)      [4562]  0-<352>-19-<245>-18-<209>-20-<230>-14-<212>-13-<205>-12-<165>-11-<183>-10-<208>-9-<220>-8-<225>-7-<203>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<378>-21
8)      [4563]  0-<381>-20-<235>-15-<205>-16-<212>-17-<187>-1-<181>-2-<212>-3-<177>-4-<203>-5-<188>-6-<228>-18-<189>-19-<215>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
9)      [4566]  0-<381>-20-<243>-18-<221>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<229>-19-<215>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<381>-21
10)     [4569]  0-<352>-19-<215>-7-<187>-8-<194>-9-<200>-10-<171>-11-<173>-12-<203>-13-<241>-14-<264>-20-<243>-18-<221>-6-<202>-5-<209>-4-<172>-3-<216>-2-<173>-1-<176>-17-<200>-16-<179>-15-<378>-21
```
